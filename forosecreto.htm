<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>INTERNET</title>

<style>
  body {
    background-color: #000;
    color: #fff;
    font-family: Verdana, sans-serif;
    margin: 0;
    padding: 20px;
  }

  #foro {
    width: 80%;
    margin: 0 auto;
    background-color: #111;
    padding: 20px;
    border: 1px solid #555;
    border-radius: 8px;
  }

  h2 {
    text-align: center;
    margin-bottom: 20px;
  }

  textarea {
    width: 100%;
    margin-bottom: 10px;
    padding: 5px;
    border-radius: 5px;
    border: 1px solid #555;
    background-color: #222;
    color: #fff;
  }

  button {
    background-color: #008080;
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
  }

  button:hover {
    background-color: #00b3b3;
  }

  /* BOTÓN VOLVER */
  .volver-btn {
    background-color: #444;
    border: 1px solid #666;
    margin-bottom: 15px;
  }

  .volver-btn:hover {
    background-color: #666;
  }

  .comentario {
    border: 1px solid #555;
    padding: 10px;
    margin-bottom: 10px;
    background-color: #222;
    border-radius: 5px;
  }

  .respuesta {
    margin-left: 20px;
    background-color: #333;
    padding: 5px;
    margin-top: 5px;
    border-radius: 5px;
  }

  .admin-btn {
    background-color: #800000;
    font-size: 10px;
    padding: 3px 6px;
    margin-left: 5px;
  }

  .nombre-admin {
    color: gold;
    font-weight: bold;
    margin-right: 5px;
  }

  img.easter {
    display: block;
    margin-top: 10px;
    max-width: 300px;
    border: 2px solid #555;
    border-radius: 5px;
  }
</style>
</head>

<body>

<div id="foro">

  <!-- BOTÓN VOLVER -->
  <button class="volver-btn" onclick="volverInicio()">⬅ Volver a la página principal</button>

  <h2>Foro</h2>

  <textarea id="nuevoComentario" placeholder="Escribe un comentario"></textarea>
  <button onclick="publicarComentario()">Publicar comentario</button>

  <div id="comentarios" style="margin-top: 20px;"></div>
</div>

<script>
let comentarios = [];
let admin = false;
const CODIGO_SECRETO = "1234";
const URL_BOB = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQhZlh-adXw071BR2s3Qu-fHsSAfwKpQTB8CQ&s";

// VOLVER A LA PÁGINA PRINCIPAL
function volverInicio() {
  window.location.href = "index.htm"; // cambia si tu página principal tiene otro nombre
}

// Cargar comentarios guardados
window.onload = function() {
  const guardados = localStorage.getItem('foro_comentarios');
  if (guardados) comentarios = JSON.parse(guardados);
  mostrarComentarios();
}

// Guardar comentarios
function guardarComentarios() {
  localStorage.setItem('foro_comentarios', JSON.stringify(comentarios));
}

// Publicar comentario
function publicarComentario() {
  const textarea = document.getElementById('nuevoComentario');
  const texto = textarea.value.trim();
  if (texto === '') return alert('Escribe un comentario');

  if (texto.toLowerCase() === "bob") {
    comentarios.push({ esEaster: true, esAdmin: admin });
    textarea.value = '';
    guardarComentarios();
    mostrarComentarios();
    return;
  }

  if (texto === CODIGO_SECRETO) {
    admin = true;
    alert("¡Modo administrador activado!");
    textarea.value = '';
    return;
  }

  comentarios.push({ texto: texto, respuestas: [], esAdmin: admin });
  textarea.value = '';
  guardarComentarios();
  mostrarComentarios();
}

// Mostrar comentarios
function mostrarComentarios() {
  const contenedor = document.getElementById('comentarios');
  contenedor.innerHTML = '';

  comentarios.forEach((c, i) => {
    const div = document.createElement('div');
    div.className = 'comentario';

    if (c.esEaster) {
      const borrarBtn = admin ? `<button class="admin-btn" onclick="borrarComentario(${i})">Borrar Bob</button>` : '';
      div.innerHTML = `<img class="easter" src="${URL_BOB}">${borrarBtn}`;
    } else {
      const nombre = c.esAdmin ? `<span class="nombre-admin">Administrador:</span>` : '';
      const borrarBtn = admin ? `<button class="admin-btn" onclick="borrarComentario(${i})">Borrar comentario</button>` : '';

      div.innerHTML = `
        <p>${nombre}${c.texto} ${borrarBtn}</p>
        <div id="respuestas${i}"></div>
        <textarea id="respuesta${i}" placeholder="Escribe tu respuesta"></textarea>
        <button onclick="responder(${i})">Responder</button>
      `;
    }

    contenedor.appendChild(div);
    if (!c.esEaster) mostrarRespuestas(i);
  });
}

// Responder
function responder(index) {
  const textarea = document.getElementById(`respuesta${index}`);
  const texto = textarea.value.trim();
  if (texto === '') return alert('Escribe una respuesta');

  comentarios[index].respuestas.push({ texto: texto, esAdmin: admin });
  textarea.value = '';
  guardarComentarios();
  mostrarRespuestas(index);
}

// Mostrar respuestas
function mostrarRespuestas(index) {
  const contenedor = document.getElementById(`respuestas${index}`);
  contenedor.innerHTML = '';

  comentarios[index].respuestas.forEach((r, j) => {
    const nombre = r.esAdmin ? `<span class="nombre-admin">Administrador:</span>` : '';
    const borrarBtn = admin ? `<button class="admin-btn" onclick="borrarRespuesta(${index}, ${j})">Borrar respuesta</button>` : '';
    contenedor.innerHTML += `<p class="respuesta">${nombre}${r.texto} ${borrarBtn}</p>`;
  });
}

// Borrar comentario
function borrarComentario(index) {
  if (confirm('¿Seguro que quieres borrar este comentario?')) {
    comentarios.splice(index, 1);
    guardarComentarios();
    mostrarComentarios();
  }
}

// Borrar respuesta
function borrarRespuesta(c, r) {
  if (confirm('¿Seguro que quieres borrar esta respuesta?')) {
    comentarios[c].respuestas.splice(r, 1);
    guardarComentarios();
    mostrarRespuestas(c);
  }
}
</script>

</body>
</html>
